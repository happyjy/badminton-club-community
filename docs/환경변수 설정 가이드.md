# í™˜ê²½ë³€ìˆ˜ ì„¤ì • ê°€ì´ë“œ

## ğŸ“ .env.local íŒŒì¼ ìƒì„±

í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— `.env.local` íŒŒì¼ì„ ìƒì„±í•˜ê³  ì•„ë˜ ë‚´ìš©ì„ ë³µì‚¬í•˜ì„¸ìš”.

```bash
# ===================================
# Supabase Database ì„¤ì •
# ===================================

# API ìš”ì²­ìš© - Transaction Mode (Pooler)
# Supabase Dashboard â†’ Settings â†’ Database â†’ Connection string â†’ Transaction ë³µì‚¬ í›„
# ëì— ?pgbouncer=true&connection_limit=5&pool_timeout=20 ì¶”ê°€
DATABASE_URL="postgresql://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:6543/postgres?pgbouncer=true&connection_limit=5&pool_timeout=20"

# ë§ˆì´ê·¸ë ˆì´ì…˜ìš© - Session Mode (Direct)
# Supabase Dashboard â†’ Settings â†’ Database â†’ Connection string â†’ Session ë³µì‚¬
DIRECT_URL="postgresql://postgres.[project-ref]:[password]@db.[project-ref].supabase.co:5432/postgres"

# ===================================
# Supabase Client ì„¤ì •
# ===================================

# Supabase Dashboard â†’ Settings â†’ API â†’ Project URL
NEXT_PUBLIC_SUPABASE_URL="https://[project-ref].supabase.co"

# Supabase Dashboard â†’ Settings â†’ API â†’ Project API keys â†’ anon public
NEXT_PUBLIC_SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

# ===================================
# ì¸ì¦ ì„¤ì •
# ===================================

# JWT Secret (ì„ì˜ì˜ ê¸´ ë¬¸ìì—´, 32ì ì´ìƒ ê¶Œì¥)
# ìƒì„± ëª…ë ¹: openssl rand -base64 32
JWT_SECRET="your-jwt-secret-key-at-least-32-characters-long"

# ===================================
# í™˜ê²½ ì„¤ì •
# ===================================

# Node í™˜ê²½ (development | production | test)
NODE_ENV="development"
```

## ğŸ” ì„¤ì • ê°’ ì°¾ëŠ” ë°©ë²•

### 1. Supabase Database URLs

1. [Supabase Dashboard](https://app.supabase.com) ì ‘ì†
2. í”„ë¡œì íŠ¸ ì„ íƒ
3. **Settings** â†’ **Database** í´ë¦­
4. **Connection string** ì„¹ì…˜ì—ì„œ:
   - **Transaction mode** ë³µì‚¬ â†’ `DATABASE_URL`ì— ë¶™ì—¬ë„£ê¸°
   - **Session mode** ë³µì‚¬ â†’ `DIRECT_URL`ì— ë¶™ì—¬ë„£ê¸°
5. `[YOUR-PASSWORD]`ë¥¼ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½

âš ï¸ **ì¤‘ìš”**: `DATABASE_URL` ëì— ë°˜ë“œì‹œ `?pgbouncer=true&connection_limit=5&pool_timeout=20` ì¶”ê°€!

### 2. Supabase API Keys

1. Supabase Dashboard â†’ **Settings** â†’ **API**
2. **Project URL** ë³µì‚¬ â†’ `NEXT_PUBLIC_SUPABASE_URL`ì— ë¶™ì—¬ë„£ê¸°
3. **Project API keys** â†’ **anon public** ë³µì‚¬ â†’ `NEXT_PUBLIC_SUPABASE_ANON_KEY`ì— ë¶™ì—¬ë„£ê¸°

### 3. JWT Secret ìƒì„±

í„°ë¯¸ë„ì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ ì‹¤í–‰:

```bash
# macOS/Linux
openssl rand -base64 32

# ë˜ëŠ” Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
```

ìƒì„±ëœ ë¬¸ìì—´ì„ `JWT_SECRET`ì— ì‚¬ìš©í•˜ì„¸ìš”.

## ğŸ”’ ë³´ì•ˆ ì£¼ì˜ì‚¬í•­

1. **ì ˆëŒ€ë¡œ `.env.local` íŒŒì¼ì„ Gitì— ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš”**
   - `.gitignore`ì— ì´ë¯¸ ì¶”ê°€ë˜ì–´ ìˆìŒ
2. **í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” í™˜ê²½ë³€ìˆ˜ë¥¼ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ì„¸ìš”**
   - Vercel: Project Settings â†’ Environment Variables
   - Docker: `.env` íŒŒì¼ ë˜ëŠ” secrets ì‚¬ìš©
3. **JWT_SECRETì€ ë°˜ë“œì‹œ ê¸´ ëœë¤ ë¬¸ìì—´ ì‚¬ìš©**
   - ìµœì†Œ 32ì ì´ìƒ
   - í”„ë¡œë•ì…˜ê³¼ ê°œë°œ í™˜ê²½ì—ì„œ ë‹¤ë¥¸ ê°’ ì‚¬ìš©

## ğŸ¯ í™˜ê²½ë³„ ì„¤ì •

### ê°œë°œ í™˜ê²½ (.env.local)

```bash
DATABASE_URL="...?pgbouncer=true&connection_limit=5&pool_timeout=20"
NODE_ENV="development"
```

### í”„ë¡œë•ì…˜ í™˜ê²½ (Vercel)

```bash
# Vercel Dashboardì—ì„œ ì„¤ì •
DATABASE_URL="...?pgbouncer=true&connection_limit=1&pool_timeout=30"
NODE_ENV="production"
```

âš ï¸ **ì„œë²„ë¦¬ìŠ¤ í™˜ê²½ì—ì„œëŠ” `connection_limit=1` ê¶Œì¥**

## âœ… ì„¤ì • í™•ì¸

í™˜ê²½ë³€ìˆ˜ê°€ ì œëŒ€ë¡œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸:

```bash
# 1. Prisma ì—°ê²° í…ŒìŠ¤íŠ¸
npx prisma studio

# 2. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
npx prisma migrate dev

# 3. ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev
```

## ğŸ› ë¬¸ì œ í•´ê²°

### "Can't reach database server"

- `DATABASE_URL`ì´ **Transaction mode** (port 6543)ì¸ì§€ í™•ì¸
- `pgbouncer=true` íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ”ì§€ í™•ì¸

### ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨

- `DIRECT_URL`ì´ **Session mode** (port 5432)ì¸ì§€ í™•ì¸
- ë¹„ë°€ë²ˆí˜¸ì— íŠ¹ìˆ˜ë¬¸ìê°€ ìˆìœ¼ë©´ URL ì¸ì½”ë”© í•„ìš”

### JWT ì¸ì¦ ì‹¤íŒ¨

- `JWT_SECRET`ì´ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
- í”„ë¡œë•ì…˜ê³¼ ê°œë°œ í™˜ê²½ì˜ JWT_SECRETì´ ë‹¤ë¥¸ì§€ í™•ì¸

## ğŸ“š ë” ìì„¸í•œ ì •ë³´

- [Supabase ì»¤ë„¥ì…˜ í’€ ì„¤ì • ê°€ì´ë“œ](./Supabase%20ì»¤ë„¥ì…˜%20í’€%20ì„¤ì •%20ê°€ì´ë“œ.md)
- [Prisma í™˜ê²½ë³€ìˆ˜ ë¬¸ì„œ](https://www.prisma.io/docs/guides/development-environment/environment-variables)
